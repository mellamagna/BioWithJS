<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="custom.css">
    <title>Contact | Mel Lamagna</title>
    <style type="text/css">
        button {
            margin-top: 5px;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>

    <div class="container-fluid" id="headernavbar">
        <header>
            <h1>Mel Lamagna</h1>
            <p>I Can Write Code Sometimes&trade;</p>
        </header>

        <ul class="nav">
            <li class="nav-item">
                <a href="index.html" class="nav-link">Home</a>
            </li>
            <li class="nav-item">
                <a href="bio.html" class="nav-link">Bio</a>
            </li>
            <li class="nav-item">
                <a href="portfolio.html" class="nav-link">Portfolio</a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link disabled">Contact</a>
            </li>
        </ul>
    </div>

    <div class="container">
        <main>
            <h2>Contact me</h2>
            <form action="success.html" method="POST">
                <div class="form-group">
                    <label for="name">Name:</label>
                    <input type="text" class="form-control" id="name" name="name">
                </div>
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" class="form-control" id="email" name="email">
                </div>
                <button type="submit" id="submit" class="btn btn-dark">Submit</button>
            </form>

            <h2>Contact list (<span id="contact-count">0</span> entries)</h2>
            <div class="container" id="contact-container">
                <div class='row'><div class='col'><b>Name</b></div><div class='col-2'><b>Email</b></div><div class='col-4'><b>Date</b></div><div class='col'><b>Actions</b></div></div></div>
            </div>
        </main>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <script>

        function addRowBorders() {
            var x = document.getElementById("contact-container").querySelectorAll("div.row");
            console.log(x.length);
            var i;
            for (i = 0; i < x.length; i++) {
                x[i].style.border = "1px solid #000000";
            }
        }
        addRowBorders();

        var counter = 0;

        const handleSubmit = event => {
			event.preventDefault();
            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const concont = document.getElementById("contact-container");
            const concount = document.getElementById("contact-count");

            const divid = name.replace(/\s/g, "");

            var div = document.createElement("div");
            div.id = divid;
            div.classList.add("row");

            var namecol = document.createElement("div");
            namecol.classList.add("col");
            namecol.innerText = name;

            var emailcol = document.createElement("div");
            emailcol.classList.add("col-2");
            emailcol.innerText = email;

            var datecol = document.createElement("div");
            datecol.classList.add("col-4");
            datecol.innerText = new Date();

            var actioncol = document.createElement("div");
            actioncol.classList.add("col");

            var contbutton = document.createElement("button");
            contbutton.classList.add("btn");
            contbutton.classList.add("btn-success");
            contbutton.innerText = "Contact";
            contbutton.value = divid;
            contbutton.addEventListener("click", handleContact);	

            var delbutton = document.createElement("button");
            delbutton.classList.add("btn");
            delbutton.classList.add("btn-danger");
            delbutton.innerText = "Delete";
            delbutton.value = divid;
            delbutton.addEventListener("click", handleDelete);	

            actioncol.appendChild(contbutton);
            actioncol.appendChild(delbutton);

            div.appendChild(namecol);
            div.appendChild(emailcol);
            div.appendChild(datecol);
            div.appendChild(actioncol);
            concont.appendChild(div);

            counter++;
            concount.innerText = counter;


            addRowBorders();
        }

        const handleContact = event => {
            event.preventDefault();
            alert(`Contacting ${event.target.value}...`);
        }
        
        const handleDelete = event => {
            event.preventDefault();
            document.getElementById(event.target.value).remove();

            const concount = document.getElementById("contact-count");

            counter--;
            concount.innerText = counter;
        }

		const submit = document.getElementById("submit");
		submit.addEventListener("click", handleSubmit);	

    </script>
</body>
</html>